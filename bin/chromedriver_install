#!/usr/bin/env bash
# Script to install Chrome and matching chromedriver at the system level for Linux
# This script is called by chromedriver_check when JS tests are detected

set -euo pipefail

sudo apt-get update -y

CHROME_DRIVER_VERSION=133.0.6943.141

# Install Chrome and Chromedriver
echo "y" | sudo npx @puppeteer/browsers install chrome@${CHROME_DRIVER_VERSION} --install-deps
echo "y" | sudo npx @puppeteer/browsers install chromedriver@${CHROME_DRIVER_VERSION}

sudo mv chrome /usr/local/ 
sudo ln -sf /usr/local/chrome/linux-${CHROME_DRIVER_VERSION}/chrome-linux64/chrome /usr/local/bin/google-chrome

sudo mv chromedriver /usr/local/ 
sudo ln -sf /usr/local/chromedriver/linux-${CHROME_DRIVER_VERSION}/chromedriver-linux64/chromedriver /usr/local/bin/chromedriver
